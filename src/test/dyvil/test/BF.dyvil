package dyvil.test

import java.util.{ Scanner, Arrays }
import java.lang.Integer => jInt
using java.lang.System._

public object BF
{	
	public static void main(String[] args)
	{
		Scanner scanner = new Scanner(System in);
		while (true)
		{
			System.out.println("Enter your Brainfuck code");
			eval(scanner, scanner nextLine);
		}
	}
	
	public static void eval(Scanner scanner, String code)
	{
		int len = code length
		int[] data = new int[30000]
		int index = 0
		
		for (int i = 0; i < len; i += 1)
		{
			char c = code charAt i
			if (c == '>') index += 1
			if (c == '<') index -= 1
			if (c == '+') data(index) += 1
			if (c == '-') data(index) -= 1
			if (c == '.') System out print(data(index) :> char)
			if (c == ',') data(index) = System in read
			if (c == '[' && data(index) == 0)
			{
				int j = 1
				while (j > 0)
				{
					i += 1
					c = code charAt i
					if (c == '[') j += 1
					if (c == ']') j -= 1
				}
			}
			if (c == ']' && data(index) != 0)
			{
				int j = 1
				while (j > 0)
				{
					i -= 1
					c = code charAt i
					if (c == '[') j -= 1
					if (c == ']') j += 1
				}
			}
		}
	}
}

package dyvil.tests

import dyvil.Test

public class OptionalTest
{
	static func apply() -> Test = test "Optionals" {
		let optString = Optional("abc")
		let string = optString ?? "def" // = "abc"

		string.staticType.toString =?= "java.lang.String"

		let optUppercase = optString?.toUpperCase ?? null
		// = optString == null ? null : optString!!.toUpperCase

		optUppercase =?= "ABC"

		let optUppercaseFirst = optString?.toUpperCase? [0] ?? 0

		optUppercaseFirst =?= 65

		test "Optional Binding" {
			if let uppercase = optUppercase { } else { fail }
			if (let u = optUppercase; !u.isEmpty) { } else { fail }
			if (let u = optUppercase, let s = u.substring(0, 1)) { s =?= "A" } else { fail }

			let s = Optional "a"
			if let s = s { s.staticType.toString =?= "java.lang.String" } else { fail }
		}
	}
}
